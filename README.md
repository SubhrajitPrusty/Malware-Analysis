# N-gram Analysis

## Requirements
- Python3
- [Dataset](https://www.kaggle.com/c/malware-classification/data)

## Usage

- **`$ python data_cry.py <no of bytes> <filename>`**
	```
	Example																											
	Input : 0B 0B 00 FF 15 15 15 FF 28 1E 00 FF FF 1B 53 FF
	Output:	0B 0B ---> 1
			00 FF ---> 2
			15 15 ---> 1
			15 FF ---> 1
			28 1E ---> 1
			FF 1B ---> 1
			53 FF ---> 1																							
	So frequency for "FF 15" is 0
	This happens because it spilts the line 2bytes from beginning.
	```


- **`$ python bytes_parser.py <no of bytes>`**
	```
	Example																											
	Input : 0B 0B 00 FF 15 15 15 FF 28 1E 00 FF FF 1B 53 FF
			28 18 ---> 1	53 FF ---> 1	15 15 ---> 2	0B 0B ---> 1
			FF FF ---> 1	1B 53 ---> 1	FF 15 ---> 1
			FF 1B ---> 1	00 FF ---> 2	15 FF ---> 1
			0B 00 ---> 1	1E 00 ---> 1	FF 28 ---> 1														

	Frequency for "FF 15" is 1.
	
	Frequency for "15 15" is 2. For "15 15 15" it gives 2 combinations. 										

	This happens because it tries to find out frequency of all possible combination of 2 bytes. 					
	Output:
		                  file  FFFFFFFF  08080808  02000000  01000000  00000000
	0  ITSUPtCmh7WdJcsYDwQ5.bytes     201.0     610.0     245.0     219.0      9367
	1  iwXK2bUysO0CPvBf8nTt.bytes       NaN       NaN       NaN       NaN      4127
	2  jEAbMPelkWmNgCrGU2QY.bytes       NaN       NaN       NaN       NaN      4313
	3  Jmo6eIhLZ4t9r8QsxEg5.bytes       NaN       NaN       NaN       NaN      3075
	4  JtPFl4ewgdD78OzCMa3o.bytes       NaN       NaN       NaN       NaN      1495
	```


- **`$ python ratio_gen.py`**
	```																
	Output:																											
		            name  ratio(bytes/asm)  ...  size(c_asm)  size(c_bytes)
	0  ITSUPtCmh7WdJcsYDwQ5          4.685180  ...       198913         719511
	1  iwXK2bUysO0CPvBf8nTt          5.326545  ...       122380         572109
	2  jEAbMPelkWmNgCrGU2QY          6.074321  ...       116583         580889
	3  Jmo6eIhLZ4t9r8QsxEg5          0.571289  ...      1217596         675094
	4  JtPFl4ewgdD78OzCMa3o          3.628505  ...       125844         396596									

	[5 rows x 7 columns] 																						

	Generates statistical data relating to file sizes in compressed and uncompressed form.
	```


- **`$ python asm_parser.py <no of process>`**
	```
	Output:
	                          advapi32.dll  comctl32.dll  ...  winmm.dll  wsock32.dll
	file                                                  ...                        
	ITSUPtCmh7WdJcsYDwQ5.asm             3           nan  ...        nan          nan
	iwXK2bUysO0CPvBf8nTt.asm             3             3  ...        nan            3
	jEAbMPelkWmNgCrGU2QY.asm             3             3  ...        nan          nan
	Jmo6eIhLZ4t9r8QsxEg5.asm           nan             3  ...          3            3
	JtPFl4ewgdD78OzCMa3o.asm             1           nan  ...          1            1
	
	[5 rows x 26 columns]

	                          .cddxu  .cgl  .data  ...  .yfshs  .ywlvnc  header
	file                                           ...                         
	ITSUPtCmh7WdJcsYDwQ5.asm     nan   nan   5431  ...     nan      nan      17
	iwXK2bUysO0CPvBf8nTt.asm     nan   nan   6286  ...     nan      nan      17
	jEAbMPelkWmNgCrGU2QY.asm     nan   nan   7714  ...     528      nan      19
	Jmo6eIhLZ4t9r8QsxEg5.asm    6675  3584    nan  ...     nan     4147      19
	JtPFl4ewgdD78OzCMa3o.asm     nan   nan   9689  ...     nan      nan      19
	
	[5 rows x 28 columns]

	                          BitmapName  Filename  LibFileName  ...  xchg  xlat  xor
	file                                                         ...                 
	ITSUPtCmh7WdJcsYDwQ5.asm         nan       nan          nan  ...     3     1   44
	iwXK2bUysO0CPvBf8nTt.asm         nan       nan          nan  ...     1   nan   70
	jEAbMPelkWmNgCrGU2QY.asm           1         1            1  ...     1   nan   48
	Jmo6eIhLZ4t9r8QsxEg5.asm         nan       nan          nan  ...   nan   nan   68
	JtPFl4ewgdD78OzCMa3o.asm         nan       nan          nan  ...     5   nan   58

	[5 rows x 220 columns] 																							
	Generates statistical data from asm files regarding use of different dll's, different sections and different opcodes.
	```
