#!/bin/bash

rm -f *.bytes
7z -r e test.7z *.bytes > /dev/null &
zip_pid=$!
sleep 15

while [ 1=1 ]
do
	kill -TSTP $zip_pid
	if [ $? -ne 0 ] 
	then
		echo "process not paused succesfully."
		kl=`pgrep -f "test.7z"` 
		kill -KIll $kl 
		break
		fi

	python3 fsocity.py 2
	if [ $? -ne 0 ] 
	then
		echo "fsocity.py stopped abrubptly."
		kl=`pgrep -f "fsocity.py"`
		kill -KILL $kl 
		kl=`pgrep -f "test.7z"` 
		kill -KIll $kl 
		break
		fi


	rm -f *.bytes


	kill -CONT $zip_pid
	if [ $? -ne 0 ] 
	then
		echo "process not resumed succesfully."
		kl=`pgrep -f "test.7z"`
		kill -KILL $kl 
		break
		fi

	echo "Extracting Data"
	sleep 5

done

exit 0
